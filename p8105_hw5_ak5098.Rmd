---
title: "Homework 5"
output: html_document
date: "2024-11-05"
---


Loading packages
```{r}
library(tidyverse)
library(dplyr)
```


##PROBLEM 2
```{r}
#writing function
sim_mean_sd = function(n, mu = 0, sigma = 5) {
  sim_data = tibble(
    x = rnorm(n, mean = mu, sd = sigma),
  )
  sim_data |> 
    summarize(
      mu_hat = mean(x),
      sigma_hat = sd(x)
    )
}

results = data.frame(mu = numeric(), mu_hat = numeric(), p_value = numeric())
#where to designate set values?
for (mu in 1:6) {
  for (i in 1:5000) {
    sim_result = sim_mean_sd(n=30, mu = mu, sigma = 5)
    t_test = t.test(sim_result, mu=0, conf.level = 0.95)
    t_test_result = broom::tidy(t_test)
    results = bind_rows(results, data.frame(
      mu = mu,
      mu_hat = t_test_result %>% select(estimate),
      p_value = t_test_result %>% select(p.value)
    ))
}}






```